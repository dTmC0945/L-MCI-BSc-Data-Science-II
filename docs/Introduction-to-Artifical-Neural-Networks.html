<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Code for Machine Learning and Data Science II Introduction to Artifical Neural Networks</title>
<meta name="author" content="Daniel McGuiness" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" href="config/style.css">
<script type="text/javascript"  src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="config/test.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script>
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "index.html");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="index.html"> UP </a>
 |
 <a accesskey="H" href=""> HOME </a>
</div><div id="content" class="content">
<h1 class="title">Code for Machine Learning and Data Science II Introduction to Artifical Neural Networks</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org7ba2df4">Introduction</a>
<ul>
<li><a href="#org923bf21">Preliminary Setup</a></li>
</ul>
</li>
<li><a href="#orge20c1da">From Biological to Artificial Neurons</a>
<ul>
<li><a href="#org614d1b5">The Perceptron</a></li>
</ul>
</li>
<li><a href="#orge91830b">Types of Activation Functions</a></li>
<li><a href="#org45a84d2">Regression MLPs</a></li>
<li><a href="#org3e839cd">Classification MLPs</a></li>
<li><a href="#org1db0de1">Implementing MLPs with Keras</a>
<ul>
<li><a href="#org957f893">Building an Image Classifier Using the Sequential API</a>
<ul>
<li><a href="#org8e0e6fc">Using Keras to load the dataset</a></li>
</ul>
</li>
<li><a href="#org0fa54c8">Compiling the Model</a></li>
<li><a href="#org7ac3a2c">Training and Evaluation</a></li>
</ul>
</li>
<li><a href="#org40c4ebb">Study: Limits of Single Layer Perceptron</a></li>
</ul>
</div>
</div>
<p>
These are the code snippets used in <code>Introduction to Artifical Neural Networks</code>
part of <code>Machine Learning and Data Science II</code>.
</p>

<div id="outline-container-org7ba2df4" class="outline-2">
<h2 id="org7ba2df4">Introduction</h2>
<div class="outline-text-2" id="text-org7ba2df4">
<p>
This part focuses on the fundamental programming knowledge of ANNs
</p>
</div>

<div id="outline-container-org923bf21" class="outline-3">
<h3 id="org923bf21">Preliminary Setup</h3>
<div class="outline-text-3" id="text-org923bf21">
<p>
To plot images in a consistent style and quality a custom package was written for the module
called ChalcedonPy which you can see its source code <a href="https://github.com/dTmC0945/ChalcedonPy">here</a>.
</p>

<p>
To install the package, simply install it via <span class="Code">pip</span>:
</p>

<div class="org-src-container">
<pre class="src src-bash" id="orgc760052">pip install ChalcedonPy
</pre>
</div>

<p>
This package needs a <span class="Hlight">save folder path</span> and a <span class="Hlight">style</span>.
</p>

<p>
In its current state there are two (<span class="Hlight">2</span>) states:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" width="100%">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">PARAMETER</th>
<th scope="col" class="org-left">FUNCTION</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><span class="Code">web</span></td>
<td class="org-left">images used in the code supplement</td>
</tr>

<tr>
<td class="org-left"><span class="Code">slide</span></td>
<td class="org-left">for use in lecture slides.</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-python" id="org0939522"><span class="org-keyword">import</span> ChalcedonPy <span class="org-keyword">as</span> cp <span class="org-comment-delimiter"># </span><span class="org-comment">custom-pakcage for lecture materials and publications</span>
<span class="org-variable-name">SAVE_PATH</span> <span class="org-operator">=</span> <span class="org-string">"Introduction-to-Artificial-Neural-Networks"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">sets the default save path</span>
<span class="org-variable-name">style</span><span class="org-operator">=</span><span class="org-string">"web"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">sets the default rcParams stylce sheet</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org09a8ffa"><span class="org-keyword">import</span> tensorflow <span class="org-keyword">as</span> tf
</pre>
</div>

<p>
In addition, make sure your <code>matplotlib</code> is configured to produce high
quality images.
</p>
</div>
</div>
</div>

<div id="outline-container-orge20c1da" class="outline-2">
<h2 id="orge20c1da">From Biological to Artificial Neurons</h2>
<div class="outline-text-2" id="text-orge20c1da">
<p>
the perceptron (or McCulloch–Pitts neuron) is an algorithm for supervised learning of binary classifiers. A binary classifier is a function which can decide whether or not an input, represented by a vector of numbers, belongs to some specific class.[1] It is a type of linear classifier, i.e. a classification algorithm that makes its predictions based on a linear predictor function combining a set of weights with the feature vector. 
</p>
</div>

<div id="outline-container-org614d1b5" class="outline-3">
<h3 id="org614d1b5">The Perceptron</h3>
<div class="outline-text-3" id="text-org614d1b5">
<div class="org-src-container">
<pre class="src src-python" id="org78e8b85"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-keyword">from</span> sklearn.datasets <span class="org-keyword">import</span> load_iris
<span class="org-keyword">from</span> sklearn.linear_model <span class="org-keyword">import</span> Perceptron

<span class="org-variable-name">iris</span> <span class="org-operator">=</span> load_iris<span class="org-rainbow-delimiters-depth-1">(</span>as_frame<span class="org-operator">=</span><span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">X</span> <span class="org-operator">=</span> iris.data<span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"petal length (cm)"</span>, <span class="org-string">"petal width (cm)"</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>.values
<span class="org-variable-name">y</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">(</span>iris.target <span class="org-operator">==</span> 0<span class="org-rainbow-delimiters-depth-1">)</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">Iris setosa</span>

<span class="org-variable-name">per_clf</span> <span class="org-operator">=</span> Perceptron<span class="org-rainbow-delimiters-depth-1">(</span>random_state<span class="org-operator">=</span>42<span class="org-rainbow-delimiters-depth-1">)</span>
per_clf.fit<span class="org-rainbow-delimiters-depth-1">(</span>X, y<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">X_new</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span>2, 0.5<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-rainbow-delimiters-depth-2">[</span>3, 1<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-variable-name">y_pred</span> <span class="org-operator">=</span> per_clf.predict<span class="org-rainbow-delimiters-depth-1">(</span>X_new<span class="org-rainbow-delimiters-depth-1">)</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">predicts True and False for these 2 flowers</span>
</pre>
</div>

<p>
Let's check the prediction of the model
</p>

<div class="org-src-container">
<pre class="src src-python" id="orgebfd383"><span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>y_pred<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org7a7eaba">
[ True False]
</pre>

<p>
<span class="Note"></span> The <code>Perceptron</code> is equivalent to a <code>SGDClassifier</code>
with loss="perceptron", no regularization, and a constant learning
rate equal to 1:
</p>

<div class="org-src-container">
<pre class="src src-python" id="org793cc64"><span class="org-comment-delimiter"># </span><span class="org-comment">extra code &#8211; shows how to build and train a Perceptron</span>

<span class="org-keyword">from</span> sklearn.linear_model <span class="org-keyword">import</span> SGDClassifier

<span class="org-variable-name">sgd_clf</span> <span class="org-operator">=</span> SGDClassifier<span class="org-rainbow-delimiters-depth-1">(</span>loss<span class="org-operator">=</span><span class="org-string">"perceptron"</span>, penalty<span class="org-operator">=</span><span class="org-constant">None</span>,
                        learning_rate<span class="org-operator">=</span><span class="org-string">"constant"</span>, eta0<span class="org-operator">=</span>1, random_state<span class="org-operator">=</span>42<span class="org-rainbow-delimiters-depth-1">)</span>
sgd_clf.fit<span class="org-rainbow-delimiters-depth-1">(</span>X, y<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">assert</span> <span class="org-rainbow-delimiters-depth-1">(</span>sgd_clf.coef_ <span class="org-operator">==</span> per_clf.coef_<span class="org-rainbow-delimiters-depth-1">)</span>.<span class="org-builtin">all</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-keyword">assert</span> <span class="org-rainbow-delimiters-depth-1">(</span>sgd_clf.intercept_ <span class="org-operator">==</span> per_clf.intercept_<span class="org-rainbow-delimiters-depth-1">)</span>.<span class="org-builtin">all</span><span class="org-rainbow-delimiters-depth-1">()</span>
</pre>
</div>

<p>
It is important to mention, when the Perceptron finds a decision boundary
that properly separates the classes, it stops learning.
</p>

<p>
This means that the decision boundary is often quite close to one class:
</p>

<div class="org-src-container">
<pre class="src src-python" id="org22e2ab0"><span class="org-comment-delimiter"># </span><span class="org-comment">extra code &#8211; plots the decision boundary of a Perceptron on the iris dataset</span>

<span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
<span class="org-keyword">from</span> matplotlib.colors <span class="org-keyword">import</span> ListedColormap

<span class="org-variable-name">a</span> <span class="org-operator">=</span> <span class="org-operator">-</span>per_clf.coef_<span class="org-rainbow-delimiters-depth-1">[</span>0, 0<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-operator">/</span> per_clf.coef_<span class="org-rainbow-delimiters-depth-1">[</span>0, 1<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-variable-name">b</span> <span class="org-operator">=</span> <span class="org-operator">-</span>per_clf.intercept_ <span class="org-operator">/</span> per_clf.coef_<span class="org-rainbow-delimiters-depth-1">[</span>0, 1<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-variable-name">axes</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">[</span>0, 5, 0, 2<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-variable-name">x0</span>, <span class="org-variable-name">x1</span> <span class="org-operator">=</span> np.meshgrid<span class="org-rainbow-delimiters-depth-1">(</span>
    np.linspace<span class="org-rainbow-delimiters-depth-2">(</span>axes<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, axes<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, 500<span class="org-rainbow-delimiters-depth-2">)</span>.reshape<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-operator">-</span>1, 1<span class="org-rainbow-delimiters-depth-2">)</span>,
    np.linspace<span class="org-rainbow-delimiters-depth-2">(</span>axes<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span>, axes<span class="org-rainbow-delimiters-depth-3">[</span>3<span class="org-rainbow-delimiters-depth-3">]</span>, 200<span class="org-rainbow-delimiters-depth-2">)</span>.reshape<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-operator">-</span>1, 1<span class="org-rainbow-delimiters-depth-2">)</span>,
<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">X_new</span> <span class="org-operator">=</span> np.c_<span class="org-rainbow-delimiters-depth-1">[</span>x0.ravel<span class="org-rainbow-delimiters-depth-2">()</span>, x1.ravel<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-variable-name">y_predict</span> <span class="org-operator">=</span> per_clf.predict<span class="org-rainbow-delimiters-depth-1">(</span>X_new<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">zz</span> <span class="org-operator">=</span> y_predict.reshape<span class="org-rainbow-delimiters-depth-1">(</span>x0.shape<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">custom_cmap</span> <span class="org-operator">=</span> ListedColormap<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">'</span><span class="custom-3"><span class="custom-4">#a6da95</span></span><span class="org-string">'</span>, <span class="org-string">'</span><span class="custom-2"><span class="custom-4">#f5a97f</span></span><span class="org-string">'</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

plt.figure<span class="org-rainbow-delimiters-depth-1">(</span>figsize<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">(</span>8, 5<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>X<span class="org-rainbow-delimiters-depth-2">[</span>y <span class="org-operator">==</span> 0, 0<span class="org-rainbow-delimiters-depth-2">]</span>, X<span class="org-rainbow-delimiters-depth-2">[</span>y <span class="org-operator">==</span> 0, 1<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"s"</span>, label<span class="org-operator">=</span><span class="org-string">"Not Iris setosa"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>X<span class="org-rainbow-delimiters-depth-2">[</span>y <span class="org-operator">==</span> 1, 0<span class="org-rainbow-delimiters-depth-2">]</span>, X<span class="org-rainbow-delimiters-depth-2">[</span>y <span class="org-operator">==</span> 1, 1<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"o"</span>, label<span class="org-operator">=</span><span class="org-string">"Iris setosa"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span>axes<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, axes<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-rainbow-delimiters-depth-2">[</span>a <span class="org-operator">*</span> axes<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> <span class="org-operator">+</span> b, a <span class="org-operator">*</span> axes<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> <span class="org-operator">+</span> b<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"k-"</span>,
         linewidth<span class="org-operator">=</span>3<span class="org-rainbow-delimiters-depth-1">)</span>
plt.contourf<span class="org-rainbow-delimiters-depth-1">(</span>x0, x1, zz, cmap<span class="org-operator">=</span>custom_cmap<span class="org-rainbow-delimiters-depth-1">)</span>
plt.xlabel<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"Petal length"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.ylabel<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"Petal width"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.legend<span class="org-rainbow-delimiters-depth-1">(</span>facecolor<span class="org-operator">=</span><span class="org-string">'</span><span class="custom"><span class="custom-1">#181926</span></span><span class="org-string">'</span>, loc<span class="org-operator">=</span><span class="org-string">"lower right"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.axis<span class="org-rainbow-delimiters-depth-1">(</span>axes<span class="org-rainbow-delimiters-depth-1">)</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"perceptron-decision"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>


<div id="orgc6ed9de" class="figure">
<p><img src="images/Introduction-to-Artificial-Neural-Networks/perceptron-decision.png" alt="perceptron-decision.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orge91830b" class="outline-2">
<h2 id="orge91830b">Types of Activation Functions</h2>
<div class="outline-text-2" id="text-orge91830b">
<p>
An activation function in the context of neural networks is a mathematical
function applied to the output of a neuron. The purpose of an activation
function is to introduce non-linearity into the model, allowing the network
to learn and represent complex patterns in the data. Without non-linearity,
a neural network would essentially behave like a linear regression model,
regardless of the number of layers it has.
</p>

<p>
Lets model some of them and compare their values.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org7312806"><span class="org-keyword">from</span> scipy.special <span class="org-keyword">import</span> expit <span class="org-keyword">as</span> sigmoid

<span class="org-keyword">def</span> <span class="org-function-name">relu</span><span class="org-rainbow-delimiters-depth-1">(</span>z<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-keyword">return</span> np.maximum<span class="org-rainbow-delimiters-depth-1">(</span>0, z<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-keyword">def</span> <span class="org-function-name">derivative</span><span class="org-rainbow-delimiters-depth-1">(</span>f, z, eps<span class="org-operator">=</span>0.000001<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-keyword">return</span> <span class="org-rainbow-delimiters-depth-1">(</span>f<span class="org-rainbow-delimiters-depth-2">(</span>z <span class="org-operator">+</span> eps<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-operator">-</span> f<span class="org-rainbow-delimiters-depth-2">(</span>z <span class="org-operator">-</span> eps<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span><span class="org-operator">/</span><span class="org-rainbow-delimiters-depth-1">(</span>2 <span class="org-operator">*</span> eps<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">max_z</span> <span class="org-operator">=</span> 4.5
<span class="org-variable-name">z</span> <span class="org-operator">=</span> np.linspace<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>max_z, max_z, 200<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
And following our functions is the plotting of course.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org1e6f8dc">plt.figure<span class="org-rainbow-delimiters-depth-1">(</span>figsize<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">(</span>12, 6<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

plt.subplot<span class="org-rainbow-delimiters-depth-1">(</span>121<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-operator">-</span>max_z, 0<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-rainbow-delimiters-depth-2">[</span>0, 0<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"-"</span>, label<span class="org-operator">=</span><span class="org-string">"Heaviside"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>z, relu<span class="org-rainbow-delimiters-depth-2">(</span>z<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-string">"-."</span>, label<span class="org-operator">=</span><span class="org-string">"ReLU"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span>0, 0<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-rainbow-delimiters-depth-2">[</span>0, 1<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span>0, max_z<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-rainbow-delimiters-depth-2">[</span>1, 1<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>z, sigmoid<span class="org-rainbow-delimiters-depth-2">(</span>z<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-string">"--"</span>, label<span class="org-operator">=</span><span class="org-string">"Sigmoid"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>z, np.tanh<span class="org-rainbow-delimiters-depth-2">(</span>z<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-string">"-"</span>, label<span class="org-operator">=</span><span class="org-string">"Tanh"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.title<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"Activation functions"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.axis<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-operator">-</span>max_z, max_z, <span class="org-operator">-</span>1.65, 2.4<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.gca<span class="org-rainbow-delimiters-depth-1">()</span>.set_yticks<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-operator">-</span>1, 0, 1, 2<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.legend<span class="org-rainbow-delimiters-depth-1">(</span>loc<span class="org-operator">=</span><span class="org-string">"lower right"</span>, fontsize<span class="org-operator">=</span>13<span class="org-rainbow-delimiters-depth-1">)</span>

plt.subplot<span class="org-rainbow-delimiters-depth-1">(</span>122<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>z, derivative<span class="org-rainbow-delimiters-depth-2">(</span>np.sign, z<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-string">"-"</span>, label<span class="org-operator">=</span><span class="org-string">"Heaviside"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>0, 0, <span class="org-string">"o"</span>, markersize<span class="org-operator">=</span>5<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>0, 0, <span class="org-string">"x"</span>, markersize<span class="org-operator">=</span>10<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>z, derivative<span class="org-rainbow-delimiters-depth-2">(</span>sigmoid, z<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-string">"--"</span>, label<span class="org-operator">=</span><span class="org-string">"Sigmoid"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>z, derivative<span class="org-rainbow-delimiters-depth-2">(</span>np.tanh, z<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-string">"-"</span>, label<span class="org-operator">=</span><span class="org-string">"Tanh"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-operator">-</span>max_z, 0<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-rainbow-delimiters-depth-2">[</span>0, 0<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"-."</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span>0, max_z<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-rainbow-delimiters-depth-2">[</span>1, 1<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"-."</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span>0, 0<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-rainbow-delimiters-depth-2">[</span>0, 1<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-string">"m-."</span>, linewidth<span class="org-operator">=</span>1.2<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>0, 1, <span class="org-string">"mo"</span>, markersize<span class="org-operator">=</span>5<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>0, 1, <span class="org-string">"mx"</span>, markersize<span class="org-operator">=</span>10<span class="org-rainbow-delimiters-depth-1">)</span>
plt.title<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"Derivatives"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.axis<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-operator">-</span>max_z, max_z, <span class="org-operator">-</span>0.2, 1.2<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"activation-functions-plot"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>

</pre>
</div>


<div id="org643502e" class="figure">
<p><img src="images/Introduction-to-Artificial-Neural-Networks/activation-functions-plot.png" alt="activation-functions-plot.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org45a84d2" class="outline-2">
<h2 id="org45a84d2">Regression MLPs</h2>
<div class="outline-text-2" id="text-org45a84d2">
<div class="org-src-container">
<pre class="src src-python" id="orgc6c892a"><span class="org-keyword">from</span> sklearn.datasets <span class="org-keyword">import</span> fetch_california_housing
<span class="org-keyword">from</span> sklearn.metrics <span class="org-keyword">import</span> mean_squared_error
<span class="org-keyword">from</span> sklearn.model_selection <span class="org-keyword">import</span> train_test_split
<span class="org-keyword">from</span> sklearn.neural_network <span class="org-keyword">import</span> MLPRegressor
<span class="org-keyword">from</span> sklearn.pipeline <span class="org-keyword">import</span> make_pipeline
<span class="org-keyword">from</span> sklearn.preprocessing <span class="org-keyword">import</span> StandardScaler

<span class="org-variable-name">housing</span> <span class="org-operator">=</span> fetch_california_housing<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-variable-name">X_train_full</span>, <span class="org-variable-name">X_test</span>, <span class="org-variable-name">y_train_full</span>, <span class="org-variable-name">y_test</span> <span class="org-operator">=</span> train_test_split<span class="org-rainbow-delimiters-depth-1">(</span>
    housing.data, housing.target, random_state<span class="org-operator">=</span>42<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">X_train</span>, <span class="org-variable-name">X_valid</span>, <span class="org-variable-name">y_train</span>, <span class="org-variable-name">y_valid</span> <span class="org-operator">=</span> train_test_split<span class="org-rainbow-delimiters-depth-1">(</span>
    X_train_full, y_train_full, random_state<span class="org-operator">=</span>42<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">mlp_reg</span> <span class="org-operator">=</span> MLPRegressor<span class="org-rainbow-delimiters-depth-1">(</span>hidden_layer_sizes<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>50, 50, 50<span class="org-rainbow-delimiters-depth-2">]</span>, random_state<span class="org-operator">=</span>42<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">pipeline</span> <span class="org-operator">=</span> make_pipeline<span class="org-rainbow-delimiters-depth-1">(</span>StandardScaler<span class="org-rainbow-delimiters-depth-2">()</span>, mlp_reg<span class="org-rainbow-delimiters-depth-1">)</span>
pipeline.fit<span class="org-rainbow-delimiters-depth-1">(</span>X_train, y_train<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y_pred</span> <span class="org-operator">=</span> pipeline.predict<span class="org-rainbow-delimiters-depth-1">(</span>X_valid<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">rmse</span> <span class="org-operator">=</span> mean_squared_error<span class="org-rainbow-delimiters-depth-1">(</span>y_valid, y_pred, squared<span class="org-operator">=</span><span class="org-constant">False</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org763e000"><span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>rmse<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="orgec03c9d">
0.5053326657968588
</pre>
</div>
</div>

<div id="outline-container-org3e839cd" class="outline-2">
<h2 id="org3e839cd">Classification MLPs</h2>
<div class="outline-text-2" id="text-org3e839cd">
<div class="org-src-container">
<pre class="src src-python" id="org60c2cec"><span class="org-keyword">from</span> sklearn.datasets <span class="org-keyword">import</span> load_iris
<span class="org-keyword">from</span> sklearn.model_selection <span class="org-keyword">import</span> train_test_split
<span class="org-keyword">from</span> sklearn.neural_network <span class="org-keyword">import</span> MLPClassifier

<span class="org-variable-name">iris</span> <span class="org-operator">=</span> load_iris<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-variable-name">X_train_full</span>, <span class="org-variable-name">X_test</span>, <span class="org-variable-name">y_train_full</span>, <span class="org-variable-name">y_test</span> <span class="org-operator">=</span> train_test_split<span class="org-rainbow-delimiters-depth-1">(</span>
    iris.data, iris.target, test_size<span class="org-operator">=</span>0.1, random_state<span class="org-operator">=</span>42<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">X_train</span>, <span class="org-variable-name">X_valid</span>, <span class="org-variable-name">y_train</span>, <span class="org-variable-name">y_valid</span> <span class="org-operator">=</span> train_test_split<span class="org-rainbow-delimiters-depth-1">(</span>
    X_train_full, y_train_full, test_size<span class="org-operator">=</span>0.1, random_state<span class="org-operator">=</span>42<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">mlp_clf</span> <span class="org-operator">=</span> MLPClassifier<span class="org-rainbow-delimiters-depth-1">(</span>hidden_layer_sizes<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>5<span class="org-rainbow-delimiters-depth-2">]</span>, max_iter<span class="org-operator">=</span>10_000,
                        random_state<span class="org-operator">=</span>42<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">pipeline</span> <span class="org-operator">=</span> make_pipeline<span class="org-rainbow-delimiters-depth-1">(</span>StandardScaler<span class="org-rainbow-delimiters-depth-2">()</span>, mlp_clf<span class="org-rainbow-delimiters-depth-1">)</span>
pipeline.fit<span class="org-rainbow-delimiters-depth-1">(</span>X_train, y_train<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">accuracy</span> <span class="org-operator">=</span> pipeline.score<span class="org-rainbow-delimiters-depth-1">(</span>X_valid, y_valid<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org2c7ef66"><span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>accuracy<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="org1367390">
1.0
</pre>
</div>
</div>

<div id="outline-container-org1db0de1" class="outline-2">
<h2 id="org1db0de1">Implementing MLPs with Keras</h2>
<div class="outline-text-2" id="text-org1db0de1">
</div>
<div id="outline-container-org957f893" class="outline-3">
<h3 id="org957f893">Building an Image Classifier Using the Sequential API</h3>
<div class="outline-text-3" id="text-org957f893">
</div>
<div id="outline-container-org8e0e6fc" class="outline-4">
<h4 id="org8e0e6fc">Using Keras to load the dataset</h4>
<div class="outline-text-4" id="text-org8e0e6fc">
<p>
Let's start by loading the fashion MNIST dataset. Keras has a number of functions to load popular datasets in tf.keras.datasets. The dataset is already split for you between a training set (60,000 images) and a test set (10,000 images), but it can be useful to split the training set further to have a validation set. We'll use 55,000 images for training, and 5,000 for validation.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org49b0497"><span class="org-keyword">import</span> tensorflow <span class="org-keyword">as</span> tf

<span class="org-variable-name">fashion_mnist</span> <span class="org-operator">=</span> tf.keras.datasets.fashion_mnist.load_data<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span>X_train_full, y_train_full<span class="org-rainbow-delimiters-depth-1">)</span>, <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">X_test</span>, <span class="org-variable-name">y_test</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">=</span> fashion_mnist
<span class="org-variable-name">X_train</span>, <span class="org-variable-name">y_train</span> <span class="org-operator">=</span> X_train_full<span class="org-rainbow-delimiters-depth-1">[</span>:<span class="org-operator">-</span>5000<span class="org-rainbow-delimiters-depth-1">]</span>, y_train_full<span class="org-rainbow-delimiters-depth-1">[</span>:<span class="org-operator">-</span>5000<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-variable-name">X_valid</span>, <span class="org-variable-name">y_valid</span> <span class="org-operator">=</span> X_train_full<span class="org-rainbow-delimiters-depth-1">[</span><span class="org-operator">-</span>5000:<span class="org-rainbow-delimiters-depth-1">]</span>, y_train_full<span class="org-rainbow-delimiters-depth-1">[</span><span class="org-operator">-</span>5000:<span class="org-rainbow-delimiters-depth-1">]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orgc9f9c4c"><span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>X_train.shape<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>X_train.dtype<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<pre class="example" id="orge82f5c5">
(55000, 28, 28)
uint8
</pre>

<div class="org-src-container">
<pre class="src src-python" id="orgbd31a41"><span class="org-variable-name">X_train</span>, <span class="org-variable-name">X_valid</span>, <span class="org-variable-name">X_test</span> <span class="org-operator">=</span> X_train <span class="org-operator">/</span> 255., X_valid <span class="org-operator">/</span> 255., X_test <span class="org-operator">/</span> 255.
</pre>
</div>

<p>
You can plot an image using Matplotlib's <code>imshow()</code> function, with a '<code>binary</code>' color map:
</p>

<div class="org-src-container">
<pre class="src src-python" id="org323a000">plt.imshow<span class="org-rainbow-delimiters-depth-1">(</span>X_train<span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span>, cmap<span class="org-operator">=</span><span class="org-string">"binary"</span><span class="org-rainbow-delimiters-depth-1">)</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"ann-shoe-plot"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>

</pre>
</div>


<div id="org10685b9" class="figure">
<p><img src="images/Introduction-to-Artificial-Neural-Networks/ann-shoe-plot.png" alt="ann-shoe-plot.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orga4938fe">y_train
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org3590783"><span class="org-variable-name">class_names</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-string">"T-shirt/top"</span>, <span class="org-string">"Trouser"</span>, <span class="org-string">"Pullover"</span>, <span class="org-string">"Dress"</span>, <span class="org-string">"Coat"</span>,
               <span class="org-string">"Sandal"</span>, <span class="org-string">"Shirt"</span>, <span class="org-string">"Sneaker"</span>, <span class="org-string">"Bag"</span>, <span class="org-string">"Ankle boot"</span><span class="org-rainbow-delimiters-depth-1">]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org9552b6c">class_names<span class="org-rainbow-delimiters-depth-1">[</span>y_train<span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org074a47e"><span class="org-variable-name">n_rows</span> <span class="org-operator">=</span> 4
<span class="org-variable-name">n_cols</span> <span class="org-operator">=</span> 10
plt.figure<span class="org-rainbow-delimiters-depth-1">(</span>figsize<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">(</span>n_cols <span class="org-operator">*</span> 1.2, n_rows <span class="org-operator">*</span> 1.2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">for</span> row <span class="org-keyword">in</span> <span class="org-builtin">range</span><span class="org-rainbow-delimiters-depth-1">(</span>n_rows<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-keyword">for</span> col <span class="org-keyword">in</span> <span class="org-builtin">range</span><span class="org-rainbow-delimiters-depth-1">(</span>n_cols<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-variable-name">index</span> <span class="org-operator">=</span> n_cols <span class="org-operator">*</span> row <span class="org-operator">+</span> col
        plt.subplot<span class="org-rainbow-delimiters-depth-1">(</span>n_rows, n_cols, index <span class="org-operator">+</span> 1<span class="org-rainbow-delimiters-depth-1">)</span>
        plt.imshow<span class="org-rainbow-delimiters-depth-1">(</span>X_train<span class="org-rainbow-delimiters-depth-2">[</span>index<span class="org-rainbow-delimiters-depth-2">]</span>, cmap<span class="org-operator">=</span><span class="org-string">"binary"</span>, interpolation<span class="org-operator">=</span><span class="org-string">"nearest"</span><span class="org-rainbow-delimiters-depth-1">)</span>
        plt.axis<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'off'</span><span class="org-rainbow-delimiters-depth-1">)</span>
        plt.title<span class="org-rainbow-delimiters-depth-1">(</span>class_names<span class="org-rainbow-delimiters-depth-2">[</span>y_train<span class="org-rainbow-delimiters-depth-3">[</span>index<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.subplots_adjust<span class="org-rainbow-delimiters-depth-1">(</span>wspace<span class="org-operator">=</span>0.2, hspace<span class="org-operator">=</span>0.5<span class="org-rainbow-delimiters-depth-1">)</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"fashion-mnist-plot"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>


</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orge570fdb">tf.random.set_seed<span class="org-rainbow-delimiters-depth-1">(</span>42<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">model</span> <span class="org-operator">=</span> tf.keras.Sequential<span class="org-rainbow-delimiters-depth-1">()</span>
model.add<span class="org-rainbow-delimiters-depth-1">(</span>tf.keras.layers.InputLayer<span class="org-rainbow-delimiters-depth-2">(</span>input_shape<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-3">[</span>28, 28<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
model.add<span class="org-rainbow-delimiters-depth-1">(</span>tf.keras.layers.Flatten<span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>
model.add<span class="org-rainbow-delimiters-depth-1">(</span>tf.keras.layers.Dense<span class="org-rainbow-delimiters-depth-2">(</span>300, activation<span class="org-operator">=</span><span class="org-string">"relu"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
model.add<span class="org-rainbow-delimiters-depth-1">(</span>tf.keras.layers.Dense<span class="org-rainbow-delimiters-depth-2">(</span>100, activation<span class="org-operator">=</span><span class="org-string">"relu"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
model.add<span class="org-rainbow-delimiters-depth-1">(</span>tf.keras.layers.Dense<span class="org-rainbow-delimiters-depth-2">(</span>10, activation<span class="org-operator">=</span><span class="org-string">"softmax"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orgdd54318">tf.keras.backend.clear_session<span class="org-rainbow-delimiters-depth-1">()</span>
tf.random.set_seed<span class="org-rainbow-delimiters-depth-1">(</span>42<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">model</span> <span class="org-operator">=</span> tf.keras.Sequential<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span>
    tf.keras.layers.Flatten<span class="org-rainbow-delimiters-depth-3">(</span>input_shape<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-4">[</span>28, 28<span class="org-rainbow-delimiters-depth-4">]</span><span class="org-rainbow-delimiters-depth-3">)</span>,
    tf.keras.layers.Dense<span class="org-rainbow-delimiters-depth-3">(</span>300, activation<span class="org-operator">=</span><span class="org-string">"relu"</span><span class="org-rainbow-delimiters-depth-3">)</span>,
    tf.keras.layers.Dense<span class="org-rainbow-delimiters-depth-3">(</span>100, activation<span class="org-operator">=</span><span class="org-string">"relu"</span><span class="org-rainbow-delimiters-depth-3">)</span>,
    tf.keras.layers.Dense<span class="org-rainbow-delimiters-depth-3">(</span>10, activation<span class="org-operator">=</span><span class="org-string">"softmax"</span><span class="org-rainbow-delimiters-depth-3">)</span>
<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orgb65bdd8">model.summary<span class="org-rainbow-delimiters-depth-1">()</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org9021b9e">tf.keras.utils.plot_model<span class="org-rainbow-delimiters-depth-1">(</span>model, <span class="org-string">"my_fashion_mnist_model.png"</span>, show_shapes<span class="org-operator">=</span><span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org27b9fee">model.layers
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orge5767c9"><span class="org-variable-name">hidden1</span> <span class="org-operator">=</span> model.layers<span class="org-rainbow-delimiters-depth-1">[</span>1<span class="org-rainbow-delimiters-depth-1">]</span>
hidden1.name
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org281b287">model.get_layer<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'dense'</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-keyword">is</span> hidden1
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org5f57090"><span class="org-variable-name">weights</span>, <span class="org-variable-name">biases</span> <span class="org-operator">=</span> hidden1.get_weights<span class="org-rainbow-delimiters-depth-1">()</span>
weights
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org7de343a">weights.shape
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orgf2173ad"><span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>biases<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orgd95f5ba">biases.shape
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0fa54c8" class="outline-3">
<h3 id="org0fa54c8">Compiling the Model</h3>
<div class="outline-text-3" id="text-org0fa54c8">
<div class="org-src-container">
<pre class="src src-python" id="org2fb8de8">model.<span class="org-builtin">compile</span><span class="org-rainbow-delimiters-depth-1">(</span>loss<span class="org-operator">=</span><span class="org-string">"sparse_categorical_crossentropy"</span>,
              optimizer<span class="org-operator">=</span><span class="org-string">"sgd"</span>,
              metrics<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"accuracy"</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org9b2a64b">model.<span class="org-builtin">compile</span><span class="org-rainbow-delimiters-depth-1">(</span>loss<span class="org-operator">=</span>tf.keras.losses.sparse_categorical_crossentropy,
              optimizer<span class="org-operator">=</span>tf.keras.optimizers.SGD<span class="org-rainbow-delimiters-depth-2">()</span>,
              metrics<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>tf.keras.metrics.sparse_categorical_accuracy<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>


<div class="org-src-container">
<pre class="src src-python" id="orge581e1b">tf.keras.utils.to_categorical<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span>0, 5, 1, 0<span class="org-rainbow-delimiters-depth-2">]</span>, num_classes<span class="org-operator">=</span>10<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orgdb9a713">np.argmax<span class="org-rainbow-delimiters-depth-1">(</span>
    <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span>1., 0., 0., 0., 0., 0., 0., 0., 0., 0.<span class="org-rainbow-delimiters-depth-3">]</span>,
     <span class="org-rainbow-delimiters-depth-3">[</span>0., 0., 0., 0., 0., 1., 0., 0., 0., 0.<span class="org-rainbow-delimiters-depth-3">]</span>,
     <span class="org-rainbow-delimiters-depth-3">[</span>0., 1., 0., 0., 0., 0., 0., 0., 0., 0.<span class="org-rainbow-delimiters-depth-3">]</span>,
     <span class="org-rainbow-delimiters-depth-3">[</span>1., 0., 0., 0., 0., 0., 0., 0., 0., 0.<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>,
    axis<span class="org-operator">=</span>1
<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7ac3a2c" class="outline-3">
<h3 id="org7ac3a2c">Training and Evaluation</h3>
<div class="outline-text-3" id="text-org7ac3a2c">
<div class="org-src-container">
<pre class="src src-python" id="orgc67063a"><span class="org-variable-name">history</span> <span class="org-operator">=</span> model.fit<span class="org-rainbow-delimiters-depth-1">(</span>X_train, y_train, epochs<span class="org-operator">=</span>30,
                    validation_data<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">(</span>X_valid, y_valid<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org6a0ca78">history.params
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org551fee3"><span class="org-builtin">print</span><span class="org-rainbow-delimiters-depth-1">(</span>history.epoch<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org5a78827"><span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
<span class="org-keyword">import</span> pandas <span class="org-keyword">as</span> pd

pd.DataFrame<span class="org-rainbow-delimiters-depth-1">(</span>history.history<span class="org-rainbow-delimiters-depth-1">)</span>.plot<span class="org-rainbow-delimiters-depth-1">(</span>
    figsize<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">(</span>8, 5<span class="org-rainbow-delimiters-depth-2">)</span>, xlim<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>0, 29<span class="org-rainbow-delimiters-depth-2">]</span>, ylim<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span>0, 1<span class="org-rainbow-delimiters-depth-2">]</span>, xlabel<span class="org-operator">=</span><span class="org-string">"Epoch"</span>,
    style<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"--"</span>, <span class="org-string">"--."</span>, <span class="org-string">"b-"</span>, <span class="org-string">"b-*"</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.legend<span class="org-rainbow-delimiters-depth-1">(</span>loc<span class="org-operator">=</span><span class="org-string">"lower left"</span><span class="org-rainbow-delimiters-depth-1">)</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">extra code</span>
store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"keras_learning_curves_plot"</span>,
          style <span class="org-operator">=</span> <span class="org-string">"web"</span><span class="org-rainbow-delimiters-depth-1">)</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">extra code</span>
plt.show<span class="org-rainbow-delimiters-depth-1">()</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org9714819">plt.figure<span class="org-rainbow-delimiters-depth-1">(</span>figsize<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">(</span>8, 5<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">for</span> key, style <span class="org-keyword">in</span> <span class="org-builtin">zip</span><span class="org-rainbow-delimiters-depth-1">(</span>history.history, <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"r--"</span>, <span class="org-string">"r--."</span>, <span class="org-string">"b-"</span>, <span class="org-string">"b-*"</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-variable-name">epochs</span> <span class="org-operator">=</span> np.array<span class="org-rainbow-delimiters-depth-1">(</span>history.epoch<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">+</span> <span class="org-rainbow-delimiters-depth-1">(</span>0 <span class="org-keyword">if</span> key.startswith<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"val_"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-keyword">else</span> <span class="org-operator">-</span>0.5<span class="org-rainbow-delimiters-depth-1">)</span>
    plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>epochs, history.history<span class="org-rainbow-delimiters-depth-2">[</span>key<span class="org-rainbow-delimiters-depth-2">]</span>, style, label<span class="org-operator">=</span>key<span class="org-rainbow-delimiters-depth-1">)</span>
plt.xlabel<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"Epoch"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.axis<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-operator">-</span>0.5, 29, 0., 1<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.legend<span class="org-rainbow-delimiters-depth-1">(</span>loc<span class="org-operator">=</span><span class="org-string">"lower left"</span><span class="org-rainbow-delimiters-depth-1">)</span>
plt.grid<span class="org-rainbow-delimiters-depth-1">()</span>
plt.show<span class="org-rainbow-delimiters-depth-1">()</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org08d5438">model.evaluate<span class="org-rainbow-delimiters-depth-1">(</span>X_test, y_test<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org40c4ebb" class="outline-2">
<h2 id="org40c4ebb">Study: Limits of Single Layer Perceptron</h2>
<div class="outline-text-2" id="text-org40c4ebb">
<p>
The data we’ll train our model on is the table we saw for the XOR function.
</p>

<div class="org-src-container">
<pre class="src src-text" id="orgd1d9fab">Data         Target
[0, 0]         0
[0, 1]         1
[1, 0]         1
[1, 1]         0
</pre>
</div>

<p>
We need some modules to import but as you can see none of them should be
new to you by now.
</p>

<div class="org-src-container">
<pre class="src src-python" id="orgb9934d6"><span class="org-keyword">from</span> itertools <span class="org-keyword">import</span> cycle
<span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
<span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-keyword">import</span> seaborn <span class="org-keyword">as</span> sns
</pre>
</div>

<p>
We next create our training data. This data is the same for each kind
of logic gate, since they all take in two boolean variables as input.
</p>

<div class="org-src-container">
<pre class="src src-python" id="orgdb84036"><span class="org-variable-name">train_data</span> <span class="org-operator">=</span> np.array<span class="org-rainbow-delimiters-depth-1">(</span>
    <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span>0, 0<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>0, 1<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1, 0<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1, 1<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">target_xor</span> <span class="org-operator">=</span> np.array<span class="org-rainbow-delimiters-depth-1">(</span>
    <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">target_nand</span> <span class="org-operator">=</span> np.array<span class="org-rainbow-delimiters-depth-1">(</span>
    <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">target_or</span> <span class="org-operator">=</span> np.array<span class="org-rainbow-delimiters-depth-1">(</span>
    <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-variable-name">target_and</span> <span class="org-operator">=</span> np.array<span class="org-rainbow-delimiters-depth-1">(</span>
    <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, <span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
We need to build our <span class="Code">Perceptron</span> class but before that lets look at its
important methods.
</p>

<p>
Here, we cycle through the data indefinitely, keeping track of
how many consecutive datapoints we correctly classified. If we manage to
classify everything in one stretch, we terminate our algorithm.
</p>

<p>
If not, it resets the counter, updates weights and continue the algorithm.
</p>

<div class="org-src-container">
<pre class="src src-python" id="orge4c510f"><span class="org-keyword">def</span> <span class="org-function-name">train</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span><span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-doc">"""</span>
<span class="org-doc">    Train a single layer perceptron.</span>
<span class="org-doc">    """</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">the number of consecutive correct classifications</span>
    <span class="org-variable-name">correct_counter</span> <span class="org-operator">=</span> 0

    <span class="org-keyword">for</span> train, target <span class="org-keyword">in</span> cycle<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-builtin">zip</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">self</span>.train_data, <span class="org-keyword">self</span>.target<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-comment-delimiter"># </span><span class="org-comment">end if all points are correctly classified</span>
        <span class="org-keyword">if</span> correct_counter <span class="org-operator">==</span> <span class="org-builtin">len</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.train_data<span class="org-rainbow-delimiters-depth-1">)</span>:
            <span class="org-keyword">break</span>

        <span class="org-variable-name">output</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.classify<span class="org-rainbow-delimiters-depth-1">(</span>train<span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-keyword">self</span>.<span class="org-variable-name">node_val</span> <span class="org-operator">=</span> train

        <span class="org-keyword">if</span> output <span class="org-operator">==</span> target:
            <span class="org-variable-name">correct_counter</span> <span class="org-operator">+=</span> 1
        <span class="org-keyword">else</span>:
            <span class="org-comment-delimiter"># </span><span class="org-comment">if incorrectly classified, update weights and reset correct_counter</span>
            <span class="org-keyword">self</span>.update_weights<span class="org-rainbow-delimiters-depth-1">(</span>target, output<span class="org-rainbow-delimiters-depth-1">)</span>
            <span class="org-variable-name">correct_counter</span> <span class="org-operator">=</span> 0
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orga0fdf18"><span class="org-keyword">def</span> <span class="org-function-name">_gradient</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, node, exp, output<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-doc">"""</span>
<span class="org-doc">    Return the gradient for a weight.</span>
<span class="org-doc">    This is the value of delta-w.</span>
<span class="org-doc">    """</span>
    <span class="org-keyword">return</span> node <span class="org-operator">*</span> <span class="org-rainbow-delimiters-depth-1">(</span>exp <span class="org-operator">-</span> output<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-keyword">def</span> <span class="org-function-name">update_weights</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, exp, output<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-doc">"""</span>
<span class="org-doc">    Update weights and bias based on their respective gradients</span>
<span class="org-doc">    """</span>
    <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.input_nodes<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-keyword">self</span>.<span class="org-variable-name">w</span><span class="org-rainbow-delimiters-depth-1">[</span>i<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-operator">+=</span> <span class="org-keyword">self</span>.lr <span class="org-operator">*</span> <span class="org-keyword">self</span>._gradient<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.node_val<span class="org-rainbow-delimiters-depth-2">[</span>i<span class="org-rainbow-delimiters-depth-2">]</span>, exp, output<span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">the value of the bias node can be considered as</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">being 1 and the weight between this node</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">and the output node being self.b</span>
    <span class="org-keyword">self</span>.<span class="org-variable-name">b</span> <span class="org-operator">+=</span> <span class="org-keyword">self</span>.lr <span class="org-operator">*</span> <span class="org-keyword">self</span>._gradient<span class="org-rainbow-delimiters-depth-1">(</span>1, exp, output<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-keyword">def</span> <span class="org-function-name">forward</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, datapoint<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-doc">"""</span>
<span class="org-doc">    One forward pass through the perceptron.</span>
<span class="org-doc">    Implementation of "wX + b".</span>
<span class="org-doc">    """</span>
    <span class="org-keyword">return</span> <span class="org-keyword">self</span>.b <span class="org-operator">+</span> np.dot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.w, datapoint<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-keyword">def</span> <span class="org-function-name">classify</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, datapoint<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-doc">"""</span>
<span class="org-doc">    Return the class to which a datapoint belongs based on</span>
<span class="org-doc">    the perceptron's output for that point.</span>
<span class="org-doc">    """</span>
    <span class="org-keyword">if</span> <span class="org-keyword">self</span>.forward<span class="org-rainbow-delimiters-depth-1">(</span>datapoint<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">&gt;=</span> 0:
        <span class="org-keyword">return</span> 1
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org759af3d"><span class="org-keyword">def</span> <span class="org-function-name">plot</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, h<span class="org-operator">=</span>0.01<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-doc">"""</span>
<span class="org-doc">    Generate plot of input data and decision boundary.</span>
<span class="org-doc">    """</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">setting plot properties like size, theme and axis limits</span>
    cp.plot_settings<span class="org-rainbow-delimiters-depth-1">(</span>style<span class="org-rainbow-delimiters-depth-1">)</span>
    plt.figure<span class="org-rainbow-delimiters-depth-1">(</span>figsize<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">(</span>20, 20<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

    plt.axis<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'scaled'</span><span class="org-rainbow-delimiters-depth-1">)</span>
    plt.xlim<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>0.1, 1.1<span class="org-rainbow-delimiters-depth-1">)</span>
    plt.ylim<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>0.1, 1.1<span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-variable-name">colors</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">{</span>
        0: <span class="org-string">"ro"</span>,
        1: <span class="org-string">"go"</span>
    <span class="org-rainbow-delimiters-depth-1">}</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">plotting the four datapoints</span>
    <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-builtin">len</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">self</span>.train_data<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>:
        plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-keyword">self</span>.train_data<span class="org-rainbow-delimiters-depth-3">[</span>i<span class="org-rainbow-delimiters-depth-3">][</span>0<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>,
                 <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-keyword">self</span>.train_data<span class="org-rainbow-delimiters-depth-3">[</span>i<span class="org-rainbow-delimiters-depth-3">][</span>1<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>,
                 colors<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-keyword">self</span>.target<span class="org-rainbow-delimiters-depth-3">[</span>i<span class="org-rainbow-delimiters-depth-3">][</span>0<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>,
                 markersize<span class="org-operator">=</span>20<span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-variable-name">x_range</span> <span class="org-operator">=</span> np.arange<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>0.1, 1.1, h<span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-variable-name">y_range</span> <span class="org-operator">=</span> np.arange<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>0.1, 1.1, h<span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">creating a mesh to plot decision boundary</span>
    <span class="org-variable-name">xx</span>, <span class="org-variable-name">yy</span> <span class="org-operator">=</span> np.meshgrid<span class="org-rainbow-delimiters-depth-1">(</span>x_range, y_range, indexing<span class="org-operator">=</span><span class="org-string">'ij'</span><span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-variable-name">Z</span> <span class="org-operator">=</span> np.array<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span><span class="org-keyword">self</span>.classify<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">[</span>x, y<span class="org-rainbow-delimiters-depth-5">]</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-keyword">for</span> x <span class="org-keyword">in</span> x_range<span class="org-rainbow-delimiters-depth-3">]</span> <span class="org-keyword">for</span> y <span class="org-keyword">in</span> y_range<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">using the contourf function to create the plot</span>
    plt.contourf<span class="org-rainbow-delimiters-depth-1">(</span>xx, yy, Z, colors<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">'red'</span>, <span class="org-string">'green'</span>, <span class="org-string">'green'</span>, <span class="org-string">'blue'</span><span class="org-rainbow-delimiters-depth-2">]</span>, alpha<span class="org-operator">=</span>0.4<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Putting this all together we get the Perceptron class,
</p>

<div class="org-src-container">
<pre class="src src-python" id="orgf2a8d1a"><span class="org-keyword">class</span> <span class="org-type">Perceptron</span>:
    <span class="org-doc">"""</span>
<span class="org-doc">    Create a perceptron.</span>
<span class="org-doc">    train_data: A 4x2 matrix with the input data.</span>
<span class="org-doc">    target: A 4x1 matrix with the perceptron's expected outputs</span>
<span class="org-doc">    lr: the learning rate. Defaults to 0.01</span>
<span class="org-doc">    input_nodes: the number of nodes in the input layer of the perceptron.</span>
<span class="org-doc">        Should be equal to the second dimension of train_data.</span>
<span class="org-doc">    """</span>

    <span class="org-keyword">def</span> <span class="org-function-name">__init__</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, train_data, target, lr<span class="org-operator">=</span>0.01, input_nodes<span class="org-operator">=</span>2<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-keyword">self</span>.<span class="org-variable-name">train_data</span> <span class="org-operator">=</span> train_data
        <span class="org-keyword">self</span>.<span class="org-variable-name">target</span> <span class="org-operator">=</span> target
        <span class="org-keyword">self</span>.<span class="org-variable-name">lr</span> <span class="org-operator">=</span> lr
        <span class="org-keyword">self</span>.<span class="org-variable-name">input_nodes</span> <span class="org-operator">=</span> input_nodes

        <span class="org-comment-delimiter"># </span><span class="org-comment">randomly initialize the weights and set the bias to -1.</span>
        <span class="org-keyword">self</span>.<span class="org-variable-name">w</span> <span class="org-operator">=</span> np.random.uniform<span class="org-rainbow-delimiters-depth-1">(</span>size<span class="org-operator">=</span><span class="org-keyword">self</span>.input_nodes<span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-keyword">self</span>.<span class="org-variable-name">b</span> <span class="org-operator">=</span> <span class="org-operator">-</span>1

        <span class="org-comment-delimiter"># </span><span class="org-comment">node_val hold the values of each node at a given point of time.</span>
        <span class="org-keyword">self</span>.<span class="org-variable-name">node_val</span> <span class="org-operator">=</span> np.zeros<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.input_nodes<span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-keyword">def</span> <span class="org-function-name">_gradient</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, node, exp, output<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-doc">"""</span>
<span class="org-doc">        Return the gradient for a weight.</span>
<span class="org-doc">        This is the value of delta-w.</span>
<span class="org-doc">        """</span>
        <span class="org-keyword">return</span> node <span class="org-operator">*</span> <span class="org-rainbow-delimiters-depth-1">(</span>exp <span class="org-operator">-</span> output<span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-keyword">def</span> <span class="org-function-name">update_weights</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, exp, output<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-doc">"""</span>
<span class="org-doc">        Update weights and bias based on their respective gradients</span>
<span class="org-doc">        """</span>
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.input_nodes<span class="org-rainbow-delimiters-depth-1">)</span>:
            <span class="org-keyword">self</span>.<span class="org-variable-name">w</span><span class="org-rainbow-delimiters-depth-1">[</span>i<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-operator">+=</span> <span class="org-keyword">self</span>.lr <span class="org-operator">*</span> <span class="org-keyword">self</span>._gradient<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.node_val<span class="org-rainbow-delimiters-depth-2">[</span>i<span class="org-rainbow-delimiters-depth-2">]</span>, exp, output<span class="org-rainbow-delimiters-depth-1">)</span>

        <span class="org-comment-delimiter"># </span><span class="org-comment">the value of the bias node can be considered as being 1 and the weight between this node</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">and the output node being self.b</span>
        <span class="org-keyword">self</span>.<span class="org-variable-name">b</span> <span class="org-operator">+=</span> <span class="org-keyword">self</span>.lr <span class="org-operator">*</span> <span class="org-keyword">self</span>._gradient<span class="org-rainbow-delimiters-depth-1">(</span>1, exp, output<span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-keyword">def</span> <span class="org-function-name">forward</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, datapoint<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-doc">"""</span>
<span class="org-doc">        One forward pass through the perceptron.</span>
<span class="org-doc">        Implementation of "wX + b".</span>
<span class="org-doc">        """</span>
        <span class="org-keyword">return</span> <span class="org-keyword">self</span>.b <span class="org-operator">+</span> np.dot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.w, datapoint<span class="org-rainbow-delimiters-depth-1">)</span>

    <span class="org-keyword">def</span> <span class="org-function-name">classify</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, datapoint<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-doc">"""</span>
<span class="org-doc">        Return the class to which a datapoint belongs based on</span>
<span class="org-doc">        the perceptron's output for that point.</span>
<span class="org-doc">        """</span>
        <span class="org-keyword">if</span> <span class="org-keyword">self</span>.forward<span class="org-rainbow-delimiters-depth-1">(</span>datapoint<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-operator">&gt;=</span> 0:
            <span class="org-keyword">return</span> 1

        <span class="org-keyword">return</span> 0
    <span class="org-keyword">def</span> <span class="org-function-name">plot</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>, h<span class="org-operator">=</span>0.01<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-doc">"""</span>
<span class="org-doc">        Generate plot of input data and decision boundary.</span>
<span class="org-doc">        """</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">setting plot properties like size, theme and axis limits</span>
        cp.plot_settings<span class="org-rainbow-delimiters-depth-1">(</span>size <span class="org-operator">=</span> <span class="org-constant">None</span>,
                         style <span class="org-operator">=</span> style<span class="org-rainbow-delimiters-depth-1">)</span>

        plt.figure<span class="org-rainbow-delimiters-depth-1">(</span>figsize<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">(</span>8, 8<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

        plt.axis<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">'scaled'</span><span class="org-rainbow-delimiters-depth-1">)</span>
        plt.xlim<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>0.1, 1.1<span class="org-rainbow-delimiters-depth-1">)</span>
        plt.ylim<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>0.1, 1.1<span class="org-rainbow-delimiters-depth-1">)</span>

        <span class="org-variable-name">colors</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">{</span>
            0: <span class="org-string">"ro"</span>,
            1: <span class="org-string">"go"</span>
        <span class="org-rainbow-delimiters-depth-1">}</span>

        <span class="org-comment-delimiter"># </span><span class="org-comment">plotting the four datapoints</span>
        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-builtin">len</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">self</span>.train_data<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>:
            plt.plot<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-keyword">self</span>.train_data<span class="org-rainbow-delimiters-depth-3">[</span>i<span class="org-rainbow-delimiters-depth-3">][</span>0<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>,
                     <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-keyword">self</span>.train_data<span class="org-rainbow-delimiters-depth-3">[</span>i<span class="org-rainbow-delimiters-depth-3">][</span>1<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>,
                     colors<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-keyword">self</span>.target<span class="org-rainbow-delimiters-depth-3">[</span>i<span class="org-rainbow-delimiters-depth-3">][</span>0<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>,
                     markersize<span class="org-operator">=</span>20<span class="org-rainbow-delimiters-depth-1">)</span>

        <span class="org-variable-name">x_range</span> <span class="org-operator">=</span> np.arange<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>0.1, 1.1, h<span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-variable-name">y_range</span> <span class="org-operator">=</span> np.arange<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>0.1, 1.1, h<span class="org-rainbow-delimiters-depth-1">)</span>

        <span class="org-comment-delimiter"># </span><span class="org-comment">creating a mesh to plot decision boundary</span>
        <span class="org-variable-name">xx</span>, <span class="org-variable-name">yy</span> <span class="org-operator">=</span> np.meshgrid<span class="org-rainbow-delimiters-depth-1">(</span>x_range, y_range, indexing<span class="org-operator">=</span><span class="org-string">'ij'</span><span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-variable-name">Z</span> <span class="org-operator">=</span> np.array<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span><span class="org-keyword">self</span>.classify<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">[</span>x, y<span class="org-rainbow-delimiters-depth-5">]</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-keyword">for</span> x <span class="org-keyword">in</span> x_range<span class="org-rainbow-delimiters-depth-3">]</span> <span class="org-keyword">for</span> y <span class="org-keyword">in</span> y_range<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>

        <span class="org-comment-delimiter"># </span><span class="org-comment">using the contourf function to create the plot</span>
        plt.contourf<span class="org-rainbow-delimiters-depth-1">(</span>xx, yy, Z, colors<span class="org-operator">=</span><span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">'red'</span>, <span class="org-string">'green'</span>, <span class="org-string">'green'</span>, <span class="org-string">'blue'</span><span class="org-rainbow-delimiters-depth-2">]</span>, alpha<span class="org-operator">=</span>0.4<span class="org-rainbow-delimiters-depth-1">)</span>


    <span class="org-keyword">def</span> <span class="org-function-name">train</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span><span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-doc">"""</span>
<span class="org-doc">        Train a single layer perceptron.</span>
<span class="org-doc">        """</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">the number of consecutive correct classifications</span>
        <span class="org-variable-name">correct_counter</span> <span class="org-operator">=</span> 0

        <span class="org-keyword">for</span> train, target <span class="org-keyword">in</span> cycle<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-builtin">zip</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">self</span>.train_data, <span class="org-keyword">self</span>.target<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>:
            <span class="org-comment-delimiter"># </span><span class="org-comment">end if all points are correctly classified</span>
            <span class="org-keyword">if</span> correct_counter <span class="org-operator">==</span> <span class="org-builtin">len</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">self</span>.train_data<span class="org-rainbow-delimiters-depth-1">)</span>:
                <span class="org-keyword">break</span>

            <span class="org-variable-name">output</span> <span class="org-operator">=</span> <span class="org-keyword">self</span>.classify<span class="org-rainbow-delimiters-depth-1">(</span>train<span class="org-rainbow-delimiters-depth-1">)</span>
            <span class="org-keyword">self</span>.<span class="org-variable-name">node_val</span> <span class="org-operator">=</span> train

            <span class="org-keyword">if</span> output <span class="org-operator">==</span> target:
                <span class="org-variable-name">correct_counter</span> <span class="org-operator">+=</span> 1
            <span class="org-keyword">else</span>:
                <span class="org-comment-delimiter"># </span><span class="org-comment">if incorrectly classified, update weights and reset correct_counter</span>
                <span class="org-keyword">self</span>.update_weights<span class="org-rainbow-delimiters-depth-1">(</span>target, output<span class="org-rainbow-delimiters-depth-1">)</span>
                <span class="org-variable-name">correct_counter</span> <span class="org-operator">=</span> 0
</pre>
</div>

<p>
Let's see if our code will be able to split the XOR diagram.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org0bf3b1f"><span class="org-variable-name">p_xor</span> <span class="org-operator">=</span> Perceptron<span class="org-rainbow-delimiters-depth-1">(</span>train_data, target_xor<span class="org-rainbow-delimiters-depth-1">)</span>
p_xor.train<span class="org-rainbow-delimiters-depth-1">()</span>
</pre>
</div>

<p>
You’ll notice that the training loop never terminates, since a
perceptron can only converge on linearly separable data. Linearly
separable data basically means that you can separate data with a point in
1D, a line in 2D, a plane in 3D and so on.
</p>

<blockquote>
<p>
A perceptron can only converge on linearly separable data.
Therefore, it isn’t capable of imitating the XOR function.
</p>
</blockquote>

<p>
Remember that a perceptron must correctly classify the entire
training data in one go. The algorithm will never hit the correct counter 4 and
therefore will loop indefinitely.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org75c0f00"><span class="org-variable-name">p_or</span> <span class="org-operator">=</span> Perceptron<span class="org-rainbow-delimiters-depth-1">(</span>train_data, target_or<span class="org-rainbow-delimiters-depth-1">)</span>
p_or.train<span class="org-rainbow-delimiters-depth-1">()</span>
p_or.plot<span class="org-rainbow-delimiters-depth-1">()</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"slp-or-plot"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>


<div id="org60a4228" class="figure">
<p><img src="images/Introduction-to-Artificial-Neural-Networks/slp-or-plot.png" alt="slp-or-plot.png" />
</p>
</div>

<p>
It seems it was able to cut through without much of a problem. Let's look at the
NAND gate.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org02109c8"><span class="org-variable-name">p_nand</span> <span class="org-operator">=</span> Perceptron<span class="org-rainbow-delimiters-depth-1">(</span>train_data, target_nand<span class="org-rainbow-delimiters-depth-1">)</span>
p_nand.train<span class="org-rainbow-delimiters-depth-1">()</span>
p_nand.plot<span class="org-rainbow-delimiters-depth-1">()</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"slp-nand-plot"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>


<div id="org96b326c" class="figure">
<p><img src="images/Introduction-to-Artificial-Neural-Networks/slp-nand-plot.png" alt="slp-nand-plot.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orgb07b489"><span class="org-variable-name">p_and</span> <span class="org-operator">=</span> Perceptron<span class="org-rainbow-delimiters-depth-1">(</span>train_data, target_and<span class="org-rainbow-delimiters-depth-1">)</span>
p_and.train<span class="org-rainbow-delimiters-depth-1">()</span>
</pre>
</div>

<p>
Excellent. It seems both these gates work well. Time to combine them.
</p>

<div class="org-src-container">
<pre class="src src-python" id="org369bf0e"><span class="org-keyword">def</span> <span class="org-function-name">XOR</span><span class="org-rainbow-delimiters-depth-1">(</span>x1, x2<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-doc">"""</span>
<span class="org-doc">    Return the boolean XOR of x1 and x2</span>
<span class="org-doc">    """</span>

    <span class="org-variable-name">x</span> <span class="org-operator">=</span> <span class="org-rainbow-delimiters-depth-1">[</span>x1, x2<span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-variable-name">p_or</span> <span class="org-operator">=</span> Perceptron<span class="org-rainbow-delimiters-depth-1">(</span>train_data, target_or<span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-variable-name">p_nand</span> <span class="org-operator">=</span> Perceptron<span class="org-rainbow-delimiters-depth-1">(</span>train_data, target_nand<span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-variable-name">p_and</span> <span class="org-operator">=</span> Perceptron<span class="org-rainbow-delimiters-depth-1">(</span>train_data, target_and<span class="org-rainbow-delimiters-depth-1">)</span>

    p_or.train<span class="org-rainbow-delimiters-depth-1">()</span>
    p_nand.train<span class="org-rainbow-delimiters-depth-1">()</span>
    p_and.train<span class="org-rainbow-delimiters-depth-1">()</span>

    <span class="org-keyword">return</span> p_and.classify<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">[</span>p_or.classify<span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span>,
                          p_nand.classify<span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org341c63a">
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org19c3478"><span class="org-keyword">def</span> <span class="org-function-name">sigmoid</span><span class="org-rainbow-delimiters-depth-1">(</span>arr, scale<span class="org-operator">=</span>1<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-variable-name">arr</span> <span class="org-operator">=</span> np.asarray<span class="org-rainbow-delimiters-depth-1">(</span>arr<span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-variable-name">result</span> <span class="org-operator">=</span> 1<span class="org-operator">/</span><span class="org-rainbow-delimiters-depth-1">(</span>1 <span class="org-operator">+</span> np.exp<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-operator">-</span>arr<span class="org-operator">*</span>scale<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-keyword">return</span> result

<span class="org-variable-name">x</span> <span class="org-operator">=</span> np.linspace<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>5, 5<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> sigmoid<span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>x, y<span class="org-rainbow-delimiters-depth-1">)</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"act-sigmoid-plot"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>


<div id="orge64be28" class="figure">
<p><img src="images/Introduction-to-Artificial-Neural-Networks/act-sigmoid-plot.png" alt="act-sigmoid-plot.png" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-python" id="orgc8c535a"><span class="org-keyword">def</span> <span class="org-function-name">tanh</span><span class="org-rainbow-delimiters-depth-1">(</span>arr, scale<span class="org-operator">=</span>1<span class="org-rainbow-delimiters-depth-1">)</span>:
    <span class="org-variable-name">arr</span> <span class="org-operator">=</span> np.asarray<span class="org-rainbow-delimiters-depth-1">(</span>arr<span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-variable-name">result</span> <span class="org-operator">=</span> np.tanh<span class="org-rainbow-delimiters-depth-1">(</span>arr<span class="org-operator">*</span>scale<span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-keyword">return</span> result

<span class="org-variable-name">x</span> <span class="org-operator">=</span> np.linspace<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>5, 5<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> tanh<span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>x, y<span class="org-rainbow-delimiters-depth-1">)</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"act-tanh-plot"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>


<div id="orgd5bf333" class="figure">
<p><img src="images/Introduction-to-Artificial-Neural-Networks/act-tanh-plot.png" alt="act-tanh-plot.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org5601615"><span class="org-keyword">def</span> <span class="org-function-name">relu</span><span class="org-rainbow-delimiters-depth-1">(</span>arr, scale<span class="org-operator">=</span>1<span class="org-rainbow-delimiters-depth-1">)</span>:
        <span class="org-variable-name">arr</span> <span class="org-operator">=</span> np.asarray<span class="org-rainbow-delimiters-depth-1">(</span>arr<span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-variable-name">result</span> <span class="org-operator">=</span> np.maximum<span class="org-rainbow-delimiters-depth-1">(</span>0, arr<span class="org-operator">*</span>scale<span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-keyword">return</span> result

<span class="org-variable-name">x</span> <span class="org-operator">=</span> np.linspace<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-operator">-</span>10, 10<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-variable-name">y</span> <span class="org-operator">=</span> relu<span class="org-rainbow-delimiters-depth-1">(</span>x<span class="org-rainbow-delimiters-depth-1">)</span>
plt.plot<span class="org-rainbow-delimiters-depth-1">(</span>x, y<span class="org-rainbow-delimiters-depth-1">)</span>

cp.store_fig<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"act-relu-plot"</span>,
             filepath <span class="org-operator">=</span> SAVE_PATH,
             style <span class="org-operator">=</span> style,
             close <span class="org-operator">=</span> <span class="org-constant">True</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>


<div id="org5423ccb" class="figure">
<p><img src="images/Introduction-to-Artificial-Neural-Networks/act-relu-plot.png" alt="act-relu-plot.png" />
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Daniel McGuiness</p>
</div>
</body>
</html>
